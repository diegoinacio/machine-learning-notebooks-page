<!DOCTYPE html>
<html>
  <head>
    <!-- ! custom meta tags -->
    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon" />
    <title>Numerical Integration</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Diego Inácio" />
    <meta
      property="og:url"
      content="https://diegoinacio.github.io/machine-learning-notebooks/pages/integration_definite-integral.html"
    />
    <meta
      name="title"
      property="og:title"
      content="Numerical Integration >> Machine Learning Notebooks | Diego Inácio"
    />
    <meta
      name="description"
      property="og:description"
      content="Overview and implementation of some numerical methods for definite integration."
    />
    <meta
      name="image"
      property="og:image"
      content="https://diegoinacio.github.io/machine-learning-notebooks/images/thumb_integration_definite-integral.jpg"
    />
    <meta property="og:image:type" content="image/jpeg" />
    <meta property="og:type" content="article" />
    <meta property="article:author" content="Diego Inácio" />
    <meta property="article:section" content="Machine Learning Notebooks" />
    <!-- /! custom meta tags -->
    <!-- ! custom notebook style -->
    <link rel="stylesheet" href="../assets/css/notebook.css" />
    <!-- /! custom notebook style -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>

    <style type="text/css">
      .bp3-dialog-container.bp3-overlay-enter-active > .bp3-dialog,
      .bp3-dialog-container.bp3-overlay-appear-active > .bp3-dialog {
        opacity: 1;
        -webkit-transform: scale(1);
        transform: scale(1);
        -webkit-transition-property: opacity, -webkit-transform;
        transition-property: opacity, -webkit-transform;
        transition-property: opacity, transform;
        transition-property: opacity, transform, -webkit-transform;
        -webkit-transition-duration: 300ms;
        transition-duration: 300ms;
        -webkit-transition-timing-function: cubic-bezier(
          0.54,
          1.12,
          0.38,
          1.11
        );
        transition-timing-function: cubic-bezier(0.54, 1.12, 0.38, 1.11);
        -webkit-transition-delay: 0;
        transition-delay: 0;
      }

      .bp3-dialog-container.bp3-overlay-exit-active > .bp3-dialog {
        opacity: 0;
        -webkit-transform: scale(0.5);
        transform: scale(0.5);
        -webkit-transition-property: opacity, -webkit-transform;
        transition-property: opacity, -webkit-transform;
        transition-property: opacity, transform;
        transition-property: opacity, transform, -webkit-transform;
        -webkit-transition-duration: 300ms;
        transition-duration: 300ms;
        -webkit-transition-timing-function: cubic-bezier(
          0.54,
          1.12,
          0.38,
          1.11
        );
        transition-timing-function: cubic-bezier(0.54, 1.12, 0.38, 1.11);
        -webkit-transition-delay: 0;
        transition-delay: 0;
      }

      .bp3-control.bp3-radio input:checked ~ .bp3-control-indicator::before {
        background-image: radial-gradient(
          #ffffff,
          #ffffff 28%,
          transparent 32%
        );
      }

      .bp3-popover-enter-active > .bp3-popover,
      .bp3-popover-appear-active > .bp3-popover {
        -webkit-transform: scale(1);
        transform: scale(1);
        -webkit-transition-property: -webkit-transform;
        transition-property: -webkit-transform;
        transition-property: transform;
        transition-property: transform, -webkit-transform;
        -webkit-transition-duration: 300ms;
        transition-duration: 300ms;
        -webkit-transition-timing-function: cubic-bezier(
          0.54,
          1.12,
          0.38,
          1.11
        );
        transition-timing-function: cubic-bezier(0.54, 1.12, 0.38, 1.11);
        -webkit-transition-delay: 0;
        transition-delay: 0;
      }

      .bp3-popover-exit-active > .bp3-popover {
        -webkit-transform: scale(0.3);
        transform: scale(0.3);
        -webkit-transition-property: -webkit-transform;
        transition-property: -webkit-transform;
        transition-property: transform;
        transition-property: transform, -webkit-transform;
        -webkit-transition-duration: 300ms;
        transition-duration: 300ms;
        -webkit-transition-timing-function: cubic-bezier(
          0.54,
          1.12,
          0.38,
          1.11
        );
        transition-timing-function: cubic-bezier(0.54, 1.12, 0.38, 1.11);
        -webkit-transition-delay: 0;
        transition-delay: 0;
      }

      .bp3-toast.bp3-toast-enter-active,
      .bp3-toast.bp3-toast-appear-active {
        -webkit-transform: translateY(0);
        transform: translateY(0);
        -webkit-transition-property: -webkit-transform;
        transition-property: -webkit-transform;
        transition-property: transform;
        transition-property: transform, -webkit-transform;
        -webkit-transition-duration: 300ms;
        transition-duration: 300ms;
        -webkit-transition-timing-function: cubic-bezier(
          0.54,
          1.12,
          0.38,
          1.11
        );
        transition-timing-function: cubic-bezier(0.54, 1.12, 0.38, 1.11);
        -webkit-transition-delay: 0;
        transition-delay: 0;
      }

      .bp3-toast.bp3-toast-enter-active ~ .bp3-toast,
      .bp3-toast.bp3-toast-appear-active ~ .bp3-toast {
        -webkit-transform: translateY(0);
        transform: translateY(0);
        -webkit-transition-property: -webkit-transform;
        transition-property: -webkit-transform;
        transition-property: transform;
        transition-property: transform, -webkit-transform;
        -webkit-transition-duration: 300ms;
        transition-duration: 300ms;
        -webkit-transition-timing-function: cubic-bezier(
          0.54,
          1.12,
          0.38,
          1.11
        );
        transition-timing-function: cubic-bezier(0.54, 1.12, 0.38, 1.11);
        -webkit-transition-delay: 0;
        transition-delay: 0;
      }

      .CodeMirror-selectedtext.cm-searching {
        background-color: var(
          --jp-search-selected-match-background-color
        ) !important;
        color: var(--jp-search-selected-match-color) !important;
      }
    </style>

    <!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML-full,Safe"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
      init_mathjax = function() {
          if (window.MathJax) {
          // MathJax loaded
              MathJax.Hub.Config({
                  TeX: {
                      equationNumbers: {
                      autoNumber: "AMS",
                      useLabelIds: true
                      }
                  },
                  tex2jax: {
                      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                      processEscapes: true,
                      processEnvironments: true
                  },
                  displayAlign: 'center',
                  CommonHTML: {
                      linebreaks: {
                      automatic: true
                      }
                  },
                  "HTML-CSS": {
                      linebreaks: {
                      automatic: true
                      }
                  }
              });

              MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
          }
      }
      init_mathjax();
    </script>
    <!-- End of mathjax configuration -->
  </head>
  <body
    class="jp-Notebook"
    data-jp-theme-light="true"
    data-jp-theme-name="JupyterLab Light"
  >
    <!-- ! custom navbar -->
    <div class="notebook-navbar">
      <a href="http://diegoinacio.github.io/machine-learning-notebooks/">
        Return to <span>Machine Learning Notebooks</span>
      </a>
    </div>
    <!-- /! custom navbar -->
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt"></div>
      <div
        class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
        data-mime-type="text/markdown"
      >
        <h1 id="Numerical-Integration">
          Numerical Integration<a
            class="anchor-link"
            href="#Numerical-Integration"
            >¶</a
          >
        </h1>
        <hr />
        <ul>
          <li>Author: Diego Inácio</li>
          <li>
            GitHub:
            <a href="https://github.com/diegoinacio">github.com/diegoinacio</a>
          </li>
          <li>
            Notebook:
            <a
              href="https://github.com/diegoinacio/machine-learning-notebooks/blob/master/Mathematical-Foundations/integration_definite-integral.ipynb"
              >integration_definite-integral.ipynb</a
            >
          </li>
        </ul>
        <hr />
        <p>
          Overview and implementation of some numerical methods for
          <em>definite integration</em>.
        </p>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[1]:</div>
          <div
            class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor"
            data-type="inline"
          >
            <div class="CodeMirror cm-s-jupyter">
              <div class="highlight hl-ipython3">
                <pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt"></div>
      <div
        class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
        data-mime-type="text/markdown"
      >
        <h1 id="Definite-Integral">
          Definite Integral<a class="anchor-link" href="#Definite-Integral"
            >¶</a
          >
        </h1>
        <hr />
        $$ \large f(x)=x^3-4x^2+4x+2 $$
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[2]:</div>
          <div
            class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor"
            data-type="inline"
          >
            <div class="CodeMirror cm-s-jupyter">
              <div class="highlight hl-ipython3">
                <pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt"></div>
      <div
        class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
        data-mime-type="text/markdown"
      >
        <p>
          <img
            src="output/integration_definite-integral_integration.png"
            alt="analytical integration"
            title="Analytical integration"
          />
        </p>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt"></div>
      <div
        class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
        data-mime-type="text/markdown"
      >
        $$ \large I=\int_{a}^{b}f(x) \, dx =\int_{a}^{b}(x^3-4x^2+4x+2) \, dx $$
        <p>Given $\large a=\frac{1}{2}$ and $\large b=\frac{5}{2}$,</p>
        $$ \large
        I=\left.\left(\frac{x^4}{4}-\frac{4x^3}{3}+2x^2+2x\right)\right|_a^b =
        \frac{61}{12} \approx 5.0833 $$
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[3]:</div>
          <div
            class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor"
            data-type="inline"
          >
            <div class="CodeMirror cm-s-jupyter">
              <div class="highlight hl-ipython3">
                <pre><span></span><span class="n">I</span> <span class="o">=</span> <span class="mi">61</span><span class="o">/</span><span class="mi">12</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[4]:</div>
          <div
            class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor"
            data-type="inline"
          >
            <div class="CodeMirror cm-s-jupyter">
              <div class="highlight hl-ipython3">
                <pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="n">Ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<span class="n">Ay</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">Ax</span><span class="p">)</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt"></div>
      <div
        class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
        data-mime-type="text/markdown"
      >
        <h2 id="1.-Rectangle-rule">
          1. Rectangle rule<a class="anchor-link" href="#1.-Rectangle-rule"
            >¶</a
          >
        </h2>
        <hr />
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[5]:</div>
          <div
            class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor"
            data-type="inline"
          >
            <div class="CodeMirror cm-s-jupyter">
              <div class="highlight hl-ipython3">
                <pre><span></span><span class="o">%%time</span>
<span class="k">def</span> <span class="nf">defInt_left</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="c1"># left-hand point</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">FX</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">Xn</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">N</span>
    <span class="k">while</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span>
        <span class="n">FX</span> <span class="o">+=</span> <span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span>
        <span class="n">Xn</span> <span class="o">+=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="n">dx</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">FX</span><span class="p">,</span> <span class="n">Xn</span><span class="p">,</span> <span class="n">dx</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">I_left</span><span class="p">,</span> <span class="n">FX</span><span class="p">,</span> <span class="n">Xn</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">defInt_left</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>

            <div
              class="jp-RenderedText jp-OutputArea-output"
              data-mime-type="text/plain"
            >
              <pre>
Wall time: 0 ns
</pre
              >
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt"></div>
      <div
        class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
        data-mime-type="text/markdown"
      >
        <p>
          <img
            src="output/integration_definite-integral_rectangleLeft.png"
            alt="rectangle left-hand point"
            title="Rectangle Left-Hand Point"
          />
        </p>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[6]:</div>
          <div
            class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor"
            data-type="inline"
          >
            <div class="CodeMirror cm-s-jupyter">
              <div class="highlight hl-ipython3">
                <pre><span></span><span class="o">%%time</span>
<span class="k">def</span> <span class="nf">defInt_right</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="c1"># right-hand point</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">FX</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">Xn</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">N</span>
    <span class="k">while</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">dx</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span>
        <span class="n">FX</span> <span class="o">+=</span> <span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">dx</span><span class="p">)]</span>
        <span class="n">Xn</span> <span class="o">+=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="n">dx</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">FX</span><span class="p">,</span> <span class="n">Xn</span><span class="p">,</span> <span class="n">dx</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">I_right</span><span class="p">,</span> <span class="n">FX</span><span class="p">,</span> <span class="n">Xn</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">defInt_right</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>

            <div
              class="jp-RenderedText jp-OutputArea-output"
              data-mime-type="text/plain"
            >
              <pre>
Wall time: 0 ns
</pre
              >
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt"></div>
      <div
        class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
        data-mime-type="text/markdown"
      >
        <p>
          <img
            src="output/integration_definite-integral_rectangleRight.png"
            alt="rectangle right-hand point"
            title="Rectangle Right-Hand Point"
          />
        </p>
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[7]:</div>
          <div
            class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor"
            data-type="inline"
          >
            <div class="CodeMirror cm-s-jupyter">
              <div class="highlight hl-ipython3">
                <pre><span></span><span class="o">%%time</span>
<span class="k">def</span> <span class="nf">defInt_middle</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="c1"># middle point</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">FX</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">Xn</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">N</span>
    <span class="k">while</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">dx</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span>
        <span class="n">FX</span> <span class="o">+=</span> <span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">dx</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>
        <span class="n">Xn</span> <span class="o">+=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="n">dx</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">FX</span><span class="p">,</span> <span class="n">Xn</span><span class="p">,</span> <span class="n">dx</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">I_mid</span><span class="p">,</span> <span class="n">FX</span><span class="p">,</span> <span class="n">Xn</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">defInt_middle</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>

            <div
              class="jp-RenderedText jp-OutputArea-output"
              data-mime-type="text/plain"
            >
              <pre>
Wall time: 0 ns
</pre
              >
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt"></div>
      <div
        class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
        data-mime-type="text/markdown"
      >
        <p>
          <img
            src="output/integration_definite-integral_rectangleMiddle.png"
            alt="rectangle middle point"
            title="Rectangle Middle Point"
          />
        </p>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt"></div>
      <div
        class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
        data-mime-type="text/markdown"
      >
        <h2 id="2.-Trapezoidal-rule">
          2. Trapezoidal rule<a class="anchor-link" href="#2.-Trapezoidal-rule"
            >¶</a
          >
        </h2>
        <hr />
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[8]:</div>
          <div
            class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor"
            data-type="inline"
          >
            <div class="CodeMirror cm-s-jupyter">
              <div class="highlight hl-ipython3">
                <pre><span></span><span class="o">%%time</span>
<span class="k">def</span> <span class="nf">defInt_trapezoid</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="c1"># trapezoidal rule</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">FXa</span><span class="p">,</span> <span class="n">FXb</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[];</span> <span class="n">Xn</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">N</span>
    <span class="k">while</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">dx</span><span class="p">))</span><span class="o">*</span><span class="n">dx</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">FXa</span> <span class="o">+=</span> <span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)];</span> <span class="n">FXb</span> <span class="o">+=</span> <span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">dx</span><span class="p">)]</span>
        <span class="n">Xn</span> <span class="o">+=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="n">dx</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">FXa</span><span class="p">,</span> <span class="n">FXb</span><span class="p">,</span> <span class="n">Xn</span><span class="p">,</span> <span class="n">dx</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">I_trap</span><span class="p">,</span> <span class="n">FXa</span><span class="p">,</span> <span class="n">FXb</span><span class="p">,</span> <span class="n">Xn</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">defInt_trapezoid</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>

            <div
              class="jp-RenderedText jp-OutputArea-output"
              data-mime-type="text/plain"
            >
              <pre>
Wall time: 0 ns
</pre
              >
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt"></div>
      <div
        class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
        data-mime-type="text/markdown"
      >
        <p>
          <img
            src="output/integration_definite-integral_trapezoid.png"
            alt="trapezoidal"
            title="Trapezoidal"
          />
        </p>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt"></div>
      <div
        class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
        data-mime-type="text/markdown"
      >
        <h2 id="3.-Comparing-to-Ground-Truth">
          3. Comparing to Ground Truth<a
            class="anchor-link"
            href="#3.-Comparing-to-Ground-Truth"
            >¶</a
          >
        </h2>
        <hr />
      </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
      <div class="jp-Cell-inputWrapper">
        <div class="jp-InputArea jp-Cell-inputArea">
          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[9]:</div>
          <div
            class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor"
            data-type="inline"
          >
            <div class="CodeMirror cm-s-jupyter">
              <div class="highlight hl-ipython3">
                <pre><span></span><span class="o">%%time</span>
<span class="n">Nx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>

<span class="n">I1</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="n">I3</span><span class="p">,</span> <span class="n">I4</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">Ni</span> <span class="ow">in</span> <span class="n">Nx</span><span class="p">:</span>
    <span class="n">i1</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">defInt_left</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">Ni</span><span class="p">);</span> <span class="n">I1</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i1</span><span class="p">];</span>
    <span class="n">i2</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">defInt_right</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">Ni</span><span class="p">);</span> <span class="n">I2</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i2</span><span class="p">];</span>
    <span class="n">i3</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">defInt_middle</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">Ni</span><span class="p">);</span> <span class="n">I3</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i3</span><span class="p">];</span>
    <span class="n">i4</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">defInt_trapezoid</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">Ni</span><span class="p">);</span> <span class="n">I4</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i4</span><span class="p">];</span>
</pre>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="jp-Cell-outputWrapper">
        <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>

            <div
              class="jp-RenderedText jp-OutputArea-output"
              data-mime-type="text/plain"
            >
              <pre>
Wall time: 1.5 ms
</pre
              >
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="jp-Cell-inputWrapper">
      <div class="jp-InputPrompt jp-InputArea-prompt"></div>
      <div
        class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
        data-mime-type="text/markdown"
      >
        <p>
          <img
            src="output/integration_definite-integral_groundTruth.png"
            alt="comparing ground truth"
            title="Comparing to Ground Trouth"
          />
        </p>
      </div>
    </div>
  </body>
</html>
